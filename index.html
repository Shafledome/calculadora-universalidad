<!DOCTYPE html>
<html>
    <head>
        <title>Calculadora Universalidad - TALF</title>
        <style>
            /* cuerpo */
            body {
                margin: 0;
                font-family: Arial, Helvetica, sans-serif;
            }
            /* Estilo navbar */
            #navbar {
                overflow: hidden;
                background-color: #333;
            }
            /* Enlaces navbar */
            #navbar a {
                float: left;
                display: block;
                color: #f2f2f2;
                text-align: center;
                padding: 14px 16px;
                text-decoration: none;
                font-size: 17px;
            }
            /* hover navbar */
            #navbar a:hover {
                background-color: #ddd;
                color: black;
            }
            /* navbar limpiar */
            #navbar #limpiar {
                background-color: #4CAF50;
                position: relative;
                left: 7.1%;
            }
            /* navbar limpiar hover */
            #navbar #limpiar:hover {
                background-color: #ddd;
                color: black;
            }
            /* contenido */
            .content {
                padding: 16px;
            }
            /* funcion "sticky" se anyade con js */
            .sticky {
                position: fixed;
                top: 0;
                width: 100%;
            }
            /* padding extra para prevenir movimientos rapidos */
            .sticky + .content {
                padding-top: 60px;
            }
        </style>
    </head>
    <body>
        <div class="scroll" style="overflow-y: auto;">
            <center><h1 name="inicio">Calculadora Universalidad</h1></center>
            <center><h2 style="font-weight:normal">Teor&iacute;a de Aut&oacute;matas y Lenguajes Formales</h2></center>
            <center><h3 style="font-weight:normal"><i>Seraf&iacute;n Cort&eacute;s Ram&iacute;rez - Universidad de M&aacute;laga - Enero 2020</i></h3></center>
            <center>
                <div id="ct2"></div>
                <div id="navbar">
                    <a href="#top" id="inicio">Inicio</a>
                    <a href="#ct2" id="cantorT2">
                        <i>Cantorizaci&oacute;n Tama&ntilde;o 2</i>
                    </a>
                    <a href="#cg" id="cantorG">
                        <i>Cantorizaci&oacute;n Generalizada</i>
                    </a>
                    <a href="#dct2" id="decantorT2">
                        <i>Decantorizaci&oacute;n Tama&ntilde;o 2</i>
                    </a>
                    <a href="#dcg" id="decantorG">
                        <i>Decantorizaci&oacute;n Generalizada</i>
                    </a>
                    <a href="#god" id="codgod">
                        <i>god</i>
                    </a>
                    <a href="#degod" id="coddegod">
                        <i>degod</i>
                    </a>
                    <a href="#codi" id="codcodi">
                        <i>codi</i>
                    </a>
                    <a href="#Codi" id="codCodi">
                        <i>Codi</i>
                    </a>
                    <a href="" id="codCODI">
                        <i>CODI</i>
                    </a>
                    <a href="" id="decodi">
                        <i>decodi</i>
                    </a>
                    <a href="" id="Decodi">
                        <i>Decodi</i>
                    </a>
                    <a href="" id="DECODI">
                        <i>DECODI</i>
                    </a>
                    <a href="" onclick="limpiarCampos()" id="limpiar">
                        <i>Limpiar Campos</i>
                    </a>
                </div>
                <div id="ct2"></div> <!-- salto antes de cantorizacion t2-->
                <br>
                <br>
                <form name="cantorizacionT2">
                    <h2>
                        Codificaci&oacute;n de Cantor de tama&ntilde;o dos o <i>cantorizaci&oacute;n de tama&ntilde;o dos</i>, 
                        &sigma;<sup style="font-size: 60%;">2</sup><sub style="font-size: 60%;">1</sub>
                    </h2>
                    <h3 style="font-weight: normal">Introduce un n&uacute;mero X y un n&uacute;mero Y, ambos mayores o iguales que 0</h3>
                    X:&nbsp;&nbsp;<input type="text" size="8" name="x">&nbsp;&nbsp;&nbsp;
                    Y:&nbsp;&nbsp;<input type="text" size="8" name="y">
                    <br>
                    <br>
                    <input type="button" value="Calcular" onclick="cantorizacionTam2()">
                    <br>
                    <br>
                    Resultado:&nbsp;&nbsp;<input type="text" size="8" name="cantorizacionTam2Result" readonly>
                </form>
                <div id="cg"></div> <!-- salto antes cantorizacion g-->
                <br>
                <br>
                <form name="cantorizacionGeneral">
                    <h2>
                        Codificaci&oacute;n de Cantor Generalizada o <i>cantorizaci&oacute;n</i>, 
                        &sigma;<sup style="font-size: 60%;">k+1</sup><sub style="font-size: 60%;">1</sub>
                    </h2>
                    <h3 style="font-weight: normal">Introduce todos los valores iguales o mayores que 0 deseados separados por ; y sin espacios</h3>
                    <i><b>Ejemplo: </b>1;2;3;4</i>
                    <br>
                    <br>
                    <textarea name ="numeros" rows="4" cols="50"></textarea>
                    <br>
                    <br>
                    <input type="button" value="Calcular" onclick="cantorizacionG()">
                    <br>
                    <br>
                    Resultado:&nbsp;&nbsp;<input type="text" size="8" name="cantorizacionGResult" readonly>
                </form>
                <div id="dct2"></div> <!-- salto antes decantorizacion t2-->
                <br>
                <br>
                <form name="decantorizacionT2">
                    <h2>
                        Decodificaci&oacute;n de Cantor de tama&ntilde;o dos o <i>decantorizaci&oacute;n de tama&ntilde;o dos</i>, 
                        (&sigma;<sup style="font-size: 60%;">1</sup><sub style="font-size: 60%;">2,1</sub>,
                        &sigma;<sup style="font-size: 60%;">1</sup><sub style="font-size: 60%;">2,2</sub>)
                    </h2>
                    <h3 style="font-weight: normal;">Introduce un n&uacute;mero mayor o igual que 0</h3>
                    N&uacute;mero:&nbsp;&nbsp;<input type="text" size="8" name="n">
                    <br>
                    <br>
                    <input type="button" value="Calcular" onclick="decantorizacionTam2()">
                    <br>
                    <br>
                    Resultado:&nbsp;&nbsp;<input type="text" size="8" name="decantorizacionTam2Result" readonly>
                </form>
                <div id="dcg"></div> <!-- salto antes decantorizacion g-->
                <br>
                <br>
                <form name="decantorizacionGeneral">
                    <h2>
                        Decodificaci&oacute;n de Cantor Generalizada o <i>decantorizaci&oacute;n</i>, 
                        (&sigma;<sup style="font-size: 60%;">1</sup><sub style="font-size: 60%;">k+1,i</sub>, . . . , 
                        &sigma;<sup style="font-size: 60%;">1</sup><sub style="font-size: 60%;">k+1,k+1</sub>)
                    </h2>
                    <h3 style="font-weight: normal;">Introduce un n&uacute;mero mayor o igual que 0, y el valor de k tambi&eacute;n mayor que 0</h3>
                    <i style="font-size: 18px">
                        Recuerda que para k = 2 y i=1, la expresi&oacute;n quedar&iacute;a como:
                        &sigma;<sup style="font-size: 60%;">1</sup><sub style="font-size: 60%;">3,1</sub>
                    </i>
                    <br>
                    <br>
                    N&uacute;mero:&nbsp;&nbsp;<input type="text" size="8" name="n">&nbsp;&nbsp;&nbsp;
                    k:&nbsp;&nbsp;<input type="text" size="8" name="k">
                    <br>
                    <br>
                    <input type="button" value="Calcular" onclick="decantorizacionG()">
                    <br>
                    <br>
                    Resultado:&nbsp;&nbsp;<input type="text" size="8" name="decantorizacionGResult" readonly>
                </form>
                <div id="god"></div> <!-- salto antes god-->
                <br>
                <br>
                <form name="codificacionGodel">
                    <h2>
                        Codificaci&oacute;n de G&ouml;del o <i>g&ouml;delizaci&oacute;n</i>, <i>god</i>
                    </h2>
                    <h3 style="font-weight: normal">Introduce todos los valores iguales o mayores que 0 deseados separados por ; y sin espacios</h3>
                    <i><b>Ejemplo: </b>1;2;3;4</i>
                    <br>
                    <br>
                    <textarea name ="numeros" rows="4" cols="50"></textarea>
                    <br>
                    <br>
                    <input type="button" value="Calcular" onclick="godelizacion()">
                    <br>
                    <br>
                    Resultado:&nbsp;&nbsp;<input type="text" size="8" name="codificacionGodelResult" readonly>
                </form>
                <div id="degod"></div> <!-- salto antes degod-->
                <br>
                <br>
                <form name="decodificacionGodel">
                    <h2>
                        Decodificaci&oacute;n de G&ouml;del o <i>deg&ouml;delizaci&oacute;n</i>, <i>degod</i>
                    </h2>
                    <h3 style="font-weight: normal;">Introduce un n&uacute;mero mayor o igual que 0 <i>(devuelve las k componentes en un vector)</i></h3>
                    N&uacute;mero:&nbsp;&nbsp;<input type="text" size="8" name="n">
                    <br>
                    <br>
                    <input type="button" value="Calcular" onclick="degodelizacion()">
                    <br>
                    <br>
                    Resultado:&nbsp;&nbsp;<input type="text" size="8" name="decodificacionGodelResult" readonly>
                </form>
                <div id="codi"></div> <!-- salto antes codi-->
                <br>
                <br>
                <form name="codificacionSentenciasWhile">
                    <h2>
                        Codificaci&oacute;n de sentencias While o <i>codi</i>
                    </h2>
                    <h3 style="font-weight: normal;">Introduzca la sentencia While a codificar<b> e introduzca ; al final de cada sentencia</b></h3>
                    <p>Recuerda, las sentencias posibles son:</p>
                    <ul>
                        <li>Xi:= 0;</li>
                        <li>Xi:= Xj;</li>
                        <li>Xi:= Xj+1;</li>
                        <li>Xi:= Xj-1;</li>
                        <li>while Xi != 0 do S1 od</li>
                    </ul>
                    <p>Donde debes sustituir i y j por el indice de la variable (y S1 siendo el c&oacute;digo dentro del bucle). Los &iacute;ndices de las variables deben de ser mayores que 0.</p>
                    Sentencia o bucle While:
                    <br>
                    <br>
                    <textarea name="sentencia" rows="4" cols="50"></textarea>
                    <br>
                    <br>
                    <input type="button" value="Calcular" onclick="codi()">
                    <br>
                    <br>
                    Resultado:&nbsp;&nbsp;<input type="text" size="8" name="codificacionSentenciasWhileResult" readonly>
                </form>
                <div id="Codi"></div> <!-- salto antes Codi-->
                <br>
                <br>
                <form name="codificacionCodigosWhile">
                    <h2>
                        Codificaci&oacute;n de c&oacute;digos While o <i>Codi</i>
                    </h2>
                    <h1>
                        Work in progress. Necesita n&uacute;meros astron&oacute;micos.
                    </h1>
                    <h3 style="font-weight: normal;">Introduzca el c&oacute;digo While a codificar<b> e introduzca ; al final de cada sentencia</b></h3>
                    <p>Recuerda, las sentencias posibles son:</p>
                    <ul>
                        <li>Xi:= 0;</li>
                        <li>Xi:= Xj;</li>
                        <li>Xi:= Xj+1;</li>
                        <li>Xi:= Xj-1;</li>
                        <li>while Xi != 0 do S1 od</li>
                    </ul>
                    <p>Donde debes sustituir i y j por el indice de la variable (y S1 siendo el c&oacute;digo dentro del bucle). Los &iacute;ndices de las variables deben de ser mayores que 0.</p>
                    Sentencia o bucle While:
                    <br>
                    <br>
                    <textarea name="codigo" rows="4" cols="50"></textarea>
                    <br>
                    <br>
                    <input type="button" value="Calcular" onclick="codi()">
                    <br>
                    <br>
                    Resultado:&nbsp;&nbsp;<input type="text" size="8" name="codificacionCodigosWhileResult" readonly>
                </form>
                <br>
                <br>
            </center>
        </div>
        <script>
            // funciones para el navbar
            // cuando la pantalla haga scroll, llame a la funcion
            window.onscroll = function() {navbarScroll()};
            // obtiene nuestro navbar
            var navbar = document.getElementById("navbar");
            // obtiene el offset del navbar
            var sticky = navbar.offsetTop;
            // funcion sticky
            function navbarScroll()
            {
                if (window.pageYOffset >= sticky) {
                    navbar.classList.add("sticky");
                } else {
                    navbar.classList.remove("sticky");
                }
            }
            // funcion para limpiar todos los campos
            function limpiaCampos()
            {
                document.cantorizacionT2.x.value = "";
                document.cantorizacionT2.y.value = "";
                document.cantorizacionT2.cantorizacionTam2Result.value = "";
                document.cantorizacionGeneral.numeros.value = "";
                document.cantorizacionGeneral.cantorizacionGResult.value = "";
                document.decantorizacionT2.n.value = "";
                document.decantorizacionT2.decantorizacionTam2Result.value = "";
                document.decantorizacionGeneral.n.value = "";
                document.decantorizacionGeneral.k.value = "";
                document.decantorizacionGeneral.decantorizacionGResult.value = "";
                document.codificacionGodel.numeros.value = "";
                document.codificacionGodel.codificacionGodelResult.value = "";
                document.decodificacionGodel.n.value = "";
                document.decodificacionGodel.decodificacionGodelResult.value = "";
                document.codificacionSentenciasWhile.sentencia.value = "";
                document.codificacionSentenciasWhile.codificacionSentenciasWhileResult.value = "";
                document.codificacionCodigosWhile.codigo.value = "";
                document.codificacionCodigosWhile.codificacionCodigosWhileResult.value = "";
            }
            // funcion cantorizacion tamanyo dos
            // N^2 -> N
            function cantorizacionTam2()
            {
                var x = parseInt(document.cantorizacionT2.x.value); 
                var y = parseInt(document.cantorizacionT2.y.value);
                if ((!Number.isInteger(x) || x < 0) || (!Number.isInteger(y) || y < 0)) {
                    document.cantorizacionT2.cantorizacionTam2Result.value = "";
                    alert("Error. \nX e Y deben de ser igual o mayores que 0.")
                } else {
                    document.cantorizacionT2.cantorizacionTam2Result.value = cantorizacionTam2Return(x,y);
                }
            }
            // funcion cantorizacion tamanyo dos con return
            function cantorizacionTam2Return(x,y)
            {
                return (x+y)*(x+y+1)/2+y;
            }
            // funcion cantorizacion generalizada
            // N^(k+1) -> N
            function cantorizacionG()
            {
                var numbers = document.cantorizacionGeneral.numeros.value.split(/[;]/);
                numbers = leeArray(numbers);
                numbers.forEach(element => {
                    if (!Number.isInteger(element) || element < 0) {
                        document.cantorizacionGeneral.cantorizacionGResult.value = "";
                        alert("Error. \nCompruebe la expresion introducida en la caja de texto y vuelva a intentarlo.");
                    }
                });
                var result = cantorizacionGRec(numbers);
                document.cantorizacionGeneral.cantorizacionGResult.value = result;
            }
            function leeArray(array) {
                var result = [];
                for (i = 0; i < array.length; i++) {
                    var v = parseInt(array[i]);
                    if (v < 0) {
                        document.cantorizacionGeneral.cantorizacionGResult.value = "";
                        alert("Los numeros introducidos deben de ser naturales.");
                    }
                    result[i] = v;
                }
                return result;
            }
            // funcion cantorizacion generalizada recursiva
            function cantorizacionGRec(nums)
            {
                if (nums.length == 1) {
                    return nums[0];
                } else if (nums.length == 2) {
                    return cantorizacionTam2Return(nums[0],nums[1]);
                } else {
                    var n0 = nums[0];
                    nums.shift();
                    return cantorizacionTam2Return(n0,cantorizacionGRec(nums));
                }
            }
            // funcion decantorizacion tamanyo dos
            // N -> N
            function decantorizacionTam2()
            {
                var numero = parseInt(document.decantorizacionT2.n.value);
                if (!Number.isInteger(numero) || numero < 0) {
                    document.decantorizacionT2.decantorizacionTam2Result.value = "";
                    alert("Error. \nEl numero tiene que ser mayor o igual que 0.")
                } else {
                    document.decantorizacionT2.decantorizacionTam2Result.value = decantorizacionTam2Return(numero);
                }
            }
            // funcion decantorizacion tamanyo dos con return
            function decantorizacionTam2Return(n)
            {
                return "(" + decantorizacionTam2PrimComp(n) + "," + decantorizacionTam2SegComp(n) + ")";
            }
            // funcion decantorizacion tamanyo 2 primera componente
            function decantorizacionTam2PrimComp(n)
            {
                return diagonal(n) - decantorizacionTam2SegComp(n);
            }
            // funcion decantorizacion tamanyo 2 segunda componente

            function decantorizacionTam2SegComp(n)
            {
                return n - cantorizacionTam2Return(diagonal(n),0);
            }
            // funcion diagonal o d(z) siendo z nuestro numero
            // calculado aritmeticamente
            function diagonal(n)
            {
                return Math.trunc((Math.sqrt(8*n+1)-1)/2);
            }
            // funcion decantorizacion generalizada
            // N -> N
            function decantorizacionG()
            {
                var n = parseInt(document.decantorizacionGeneral.n.value);
                var kp1 = parseInt(document.decantorizacionGeneral.k.value)+1;
                if ((!Number.isInteger(n) || n < 0 ) ||(!Number.isInteger(kp1) || kp1 < 0)) {
                    document.decantorizacionGeneral.decantorizacionGResult.value = "";
                    alert("Error. \nEl numero y k tienen que ser mayor o igual que 0.")
                } else {
                    var result = decantorizacionGReturn(n,kp1);
                    document.decantorizacionGeneral.decantorizacionGResult.value = result.join('');
                }
            }
            // funcion decantorizacion generalizada return
            function decantorizacionGReturn(n,kp1)
            {
                var result = [];
                result.unshift(")");
                for (var i = kp1; i >= 1; i--) {
                    result.unshift(decantorizacionGRec(n,kp1,i));
                    result.unshift(",");
                }
                result.shift();
                result.unshift("(");
                return result;
            }
            // funcion decantorizacion generalizada recursiva
            function decantorizacionGRec(n,kp1,i)
            {
                if (kp1 == 1) {
                    return n;
                } else if (i == 1) {
                    return decantorizacionTam2PrimComp(n);
                } else {
                    return decantorizacionGRec(decantorizacionTam2SegComp(n),kp1-1,i-1)
                }
            }
            // funcion L(x) -> anexo 3 de godel es array.length
            // funcion godelizacion
            // N^* -> N
            function godelizacion()
            {
                var error = false;
                var numbers = document.codificacionGodel.numeros.value.split(/[;]/);
                numbers.forEach(element => {
                    if (!Number.isInteger(element) || element < 0) {
                        error = true;
                        document.codificacionGodel.codificacionGodelResult.value = "";        
                        alert("Error. \nUno de los valores introducidos no es valido.");
                    }
                });
                if (!error) document.codificacionGodel.codificacionGodelResult.value = godelizacionReturn(numbers);
            }
            // funcion godelizacion return
            function godelizacionReturn(array)
            {
                var result = 0;
                var numbers = leeArray(array);
                if (numbers.length != 0) {
                    result = cantorizacionTam2Return(numbers.length-1,cantorizacionGRec(numbers))+1;
                }
                return result;
            }
            // funcion longitud (dado un z)
            function longitud(z)
            {
                if (z == 0) {
                    return 0;
                } else {
                    return decantorizacionTam2PrimComp(z-1)+1;
                }
            }
            // funcion degodelizacion
            // N^2 -> N
            function degodelizacion()
            {
                var z = document.decodificacionGodel.n.value;
                if (!Number.isInteger(z) || z < 0) {
                    document.decodificacionGodel.decodificacionGodelResult.value = "";
                    alert("Error. \nEl valor introducido no es valido.");
                } else {
                    var result = [];
                    result.unshift(")");
                    for (var k = longitud(z); k >= 1; k--) {
                        result.unshift(degodelizacionReturn(z,k));
                        result.unshift(",");
                    }
                    result.shift();
                    result.unshift("(");
                    document.decodificacionGodel.decodificacionGodelResult.value = result.join('');
                }
            }
            // funcion degodelizacion con return
            function degodelizacionReturn(z,k)
            {
                if (z == 0 || k > longitud(z)) {
                    return 0;
                } else {
                    return decantorizacionGRec(decantorizacionTam2SegComp(z-1),longitud(z),k);
                }
            }
            // funcion codi de codificacion de sentencias while
            // Cod_While -> N
            function codi()
            {
                var arrayLinea = tratarLinea(document.codificacionSentenciasWhile.sentencia.value);
                var result = codiReturn(arrayLinea);
                if (Number.isInteger(result)) {
                    document.codificacionSentenciasWhile.codificacionSentenciasWhileResult.value = result;
                } else {
                    alert("Error. \nCompruebe la expresion introducida en la caja de texto y vuelva a intentarlo.");
                }
                
            }
            // funcion codi con return
            function codiReturn(arrayLinea)
            {
                if (arrayLinea.length == 6) {
                    if (arrayLinea[1] <= 0) {
                        return null; // indice de variable negativo o 0
                    } else {
                        return 5*(arrayLinea[1]-1);
                    }
                } else if (arrayLinea.length == 7) {
                    if (arrayLinea[1] <= 0 || arrayLinea[5] <= 0) {
                        return null; // indice de variable negativo o 0
                    } else {
                        return 5*cantorizacionTam2Return(arrayLinea[1]-1,arrayLinea[5]-1)+1;
                    }
                } else if (arrayLinea.length == 9 && arrayLinea[6] == '+') {
                    if (arrayLinea[1] <= 0 || arrayLinea[5] <= 0) {
                        return null; // indice de variable negativo o 0
                    } else {
                        return 5*cantorizacionTam2Return(arrayLinea[1]-1,arrayLinea[5]-1)+2;
                    }
                } else if (arrayLinea.length == 9 && arrayLinea[6] == '-') {
                    if (arrayLinea[1] <= 0 || arrayLinea[5] <= 0) {
                        return null; // indice de variable negativo o 0
                    } else {
                        return 5*cantorizacionTam2Return(arrayLinea[1]-1,arrayLinea[5]-1)+3;
                    }
                } else if (arrayLinea.slice(0,5).join("") == "while") {
                    if (arrayLinea[6] <= 0) {
                        return null; // indice de variable negativo o 0
                    } else {
                        return 5*cantorizacionTam2Return(arrayLinea[6]-1,CodiReturn(arrayLinea.slice(12,arrayLinea.length-2)))+4;
                    }
                } else { // se ha escrito cualquier otra cosa
                    return null;
                }
            }
            // funcion separar sentencia while
            function tratarLinea(linea)
            {
                return linea.replace(/[\s]/g,'').split('');
            }
            // funcion Codi con return
            function CodiReturn(arrayLineas)
            {
                var lineas = separarSentencias(arrayLineas);
                var result = [];
                for (var i = 0; i < lineas.length; i++) {
                    result[i] = codiReturn(tratarLinea(lineas[i]));
                }
                return godelizacionReturn(result)-1;
            }
            function separarSentencias(arrayLineas)
            {
                var result = arrayLineas.join('').replace(/;/gi, ";,").split(/\,/);
                result.pop(); // eliminamos el ultimo elemento generado por el ultimo ;
                return result;
            }
            // funcion Codificacion de codigos
            function Codi()
            {
                var arrayLineas = tratarLinea(document.codificacionCodigosWhile.codigo.value);
                var result = CodiReturn(arrayLineas);
                if (Number.isInteger(result)) {
                    document.codificacionCodigosWhile.codificacionCodigosWhileResult.value = result;
                } else {
                    alert("Error. \nCompruebe la expresion introducida en la caja de texto y vuelva a intentarlo.");
                }
                
            }
        </script>
    </body>
</html>